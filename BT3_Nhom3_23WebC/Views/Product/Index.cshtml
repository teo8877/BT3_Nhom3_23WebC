@model List<BT3_Nhom3_23WebC.Models.Product>
<div id="content" class="right">
    <h2>Products</h2>
    @foreach (var sp in Model)
    {
        <div class="product_box">
            <img src="@sp.HinhAnh" alt="@sp.TenSP" />
            <h3>@sp.TenSP (@sp.MaSP)</h3>
            <p class="product_price">Giá: @sp.DonGia - KM: @sp.DonGiaKhuyenMai</p>
            <p>@sp.MoTa</p>
            <p>Loại: @sp.LoaiSP</p>
            <p class="add_to_cart">
                <a href="@Url.Action("Index", "ProductDetail")">Chi tiết</a>
                <a href="@Url.Action("Index", "ShoppingCart")">Thêm vào giỏ</a>
            </p>
        </div>
    }
 
</div>
<hr />
<h2>Sản phẩm (load bằng Ajax)</h2>

<table id="tblProducts" border="1" style="width:100%; text-align:center;">
    <thead>
        <tr>
            <th>Mã SP</th>
            <th>Tên sản phẩm</th>
            <th>Đơn giá</th>
            <th>Khuyến mãi</th>
            <th>Loại</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function () {
            $.ajax({
                url: '/api/ProductApi',
                type: 'GET',
                success: function (data) {
                    let rows = '';
                    data.forEach(sp => {
                        rows += `
                            <tr>
                                <td>${sp.maSP}</td>
                                <td>${sp.tenSP}</td>
                                <td>${sp.donGia}</td>
                                <td>${sp.donGiaKhuyenMai}</td>
                                <td>${sp.loaiSP}</td>
                            </tr>
                        `;
                    });
                    $('#tblProducts tbody').html(rows);
                },
                error: function () {
                    alert("Không tải được dữ liệu sản phẩm!");
                }
            });
        });
    </script>
}
